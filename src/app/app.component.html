<div class="header">
  <form [formGroup]="queryForm" (ngSubmit)="onSubmit(queryForm.value)" autocomplete="off">
    <div class="form-group" [ngClass]="{'error': !validateBrand() }">
      
      <em *ngIf="!validateBrand()">Required*</em>
      
      <div class="ng-autocomplete brand">
        <ng-autocomplete 
          formControlName="brand"
          [data]="brandList"
          [searchKeyword]="searchKeyword.brand"
          (selected)='fetchModels($event)'
          (inputChanged)='onChangeSearch($event)' 
          (inputFocused)='onFocused($event)'
          [itemTemplate]="brandTemplate"
          [notFoundTemplate]="brandNotFoundTemplate"
          notFoundText="No Match Found"
          placeHolder="Select Brand..."
          (inputCleared)="clearModelAndMake($event)"
        >                                 
        </ng-autocomplete>
        
        <ng-template #brandTemplate let-item>
          <a [innerHTML]="item.default_name">{{item.default_name}}</a>
        </ng-template>

        <ng-template #brandNotFoundTemplate let-notFound>
          <div [innerHTML]="notFound"></div>
        </ng-template>
      </div>
    </div>

    <div class="form-group" [ngClass]="{'error': !validateModel() }" (blur)="disableDropdown('model')">
      
      <em *ngIf="!validateModel()">Required*</em>
      
      <div class="ng-autocomplete model">
        <ng-autocomplete #modelRef
          formControlName="model"
          [data]="modelList"
          [searchKeyword]="searchKeyword.model"
          (selected)='fetchMakeYears($event)'
          (inputChanged)='onChangeSearch($event)' 
          (inputFocused)='onFocused($event)'
          [itemTemplate]="modelTemplate"
          [notFoundTemplate]="modelNotFoundTemplate"
          notFoundText="No Match Found"
          placeHolder="Select Model..."
          (inputCleared)="clearMake($event)"
        >                                 
        </ng-autocomplete>
        
        <ng-template #modelTemplate let-item>
          <a [innerHTML]="item['model_group']"></a>
        </ng-template>

        <ng-template #modelNotFoundTemplate let-notFound>
          <div [innerHTML]="notFound"></div>
        </ng-template>
      </div>
    </div>

    <div class="form-group" [ngClass]="{'error': !validateMake() }">
      
      <em *ngIf="!validateMake() && queryForm.controls.make.errors">Required*</em>
      <!-- <em *ngIf="!validateMake() && queryForm.controls.make.errors.pattern">Make must start with a Year*</em> -->

      <div class="ng-autocomplete makeDropdown">
        <ng-autocomplete #makeRef
          formControlName="make"
          [data]="makeList"
          [searchKeyword]="searchKeyword.make"
          (inputChanged)='onChangeSearch($event)' 
          (inputFocused)='onFocused($event)'
          [itemTemplate]="makeTemplate"
          [notFoundTemplate]="makeNotFoundTemplate"
          notFoundText="No Match Found"
          placeHolder="Select Make Year..."
        >                                 
        </ng-autocomplete>
        
        <ng-template #makeTemplate let-item>
          <a [innerHTML]="item.year_model"></a>
        </ng-template>

        <ng-template #makeNotFoundTemplate let-notFound>
          <div [innerHTML]="notFound"></div>
        </ng-template>
      </div>
    </div>
    
    <div class="form-group button">
      <button type="submit" [disabled]="queryForm.invalid">Search Records</button>
    </div>

  </form>
</div>

<router-outlet></router-outlet>